<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Android menu icon, delightfully &#8211; Tadej's Blog</title>
<meta name="description" content="Starting a redesign of my app, a contemporary menu to back-arrow icon - like the one introduced in Material design, would come handy. I thought recreating it from scratch would be a great how-to exercise. Here's my recipe.">
<meta name="keywords" content="android, ui, drawable">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Android menu icon, delightfully">
<meta property="og:description" content="Starting a redesign of my app, a contemporary menu to back-arrow icon - like the one introduced in Material design, would come handy. I thought recreating it from scratch would be a great how-to exercise. Here's my recipe.">
<meta property="og:url" content="/android-menu-icon/">
<meta property="og:site_name" content="Tadej's Blog">





<link rel="canonical" href="/android-menu-icon/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tadej's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
    <button class="dl-trigger">Open Menu</button>

    <ul class="dl-menu">
        
        <li>
            <a href="/">Home</a>
        </li>

        <li>
            <a href="/about/">About</a>
        </li>

        <li>
            <a href="/posts/">Posts</a>
        </li>

        <li>
            <a href="/projects/">Projects</a>
        </li>

        
        <li>
            <a href="http://linkedin.com/in/tadejslamic"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
        </li>
        

        
        <li>
            <a href="http://github.com/tslamic"><i class="fa fa-fw fa-github"></i> GitHub</a>
        </li>
        
        
        
        <li>
            <a href="http://stackoverflow.com/users/905349/curtisloew"><i class="fa fa-fw fa-stack-exchange"></i> Stack Overflow</a>
        </li>
        

    </ul>
    
</nav>




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/android-menu-icon/" rel="bookmark" title="Android menu icon, delightfully">Android menu icon, delightfully</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2015-04-11T00:00:00-04:00">April 11, 2015</time></span></h2>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
          Reading time ~11 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>There’s probably not a single Android developer in the wild that hasn’t heard about Material design yet.</p>

<p>One of my favorite elements are subtle icon transitions, like the ones presented in <a href="http://www.google.com/design/spec/animation/delightful-details.html">delightful details</a>.</p>

<div class="center-align">
<video width="320" height="240" loop="true" autoplay="autoplay" controls="">
<source src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0B2wX4iIvu8L6ZHZfV1NfRHdCZHM/animation-delightfuldetails-030401_Status_Change_xhdpi_003.webm" type="video/webm" />
</video>
</div>

<p>Starting a redesign of my app, a menu to back-arrow icon - like the one in the top left corner - would come handy. I thought recreating it from scratch would be a great how-to exercise.</p>

<blockquote>
  <p>TL;DR Here’s the <a href="https://github.com/tslamic/DelightfulMenuDrawable">GitHub repo</a>.</p>
</blockquote>

<p><a name="sec_1"></a></p>

<h3 id="a-birds-eye-view">A bird’s eye view</h3>

<p>Menu to back-arrow icon is a simple drawable with transition animation. Both <em>states</em> consist of three sole lines. The easiest way to define the transition is to mark the points of interest:</p>

<figure class="center-align">
	<img src="http://i.imgur.com/VezpDYs.png" title="mapping" />
	<figcaption>Points will help us define the transition.</figcaption>
</figure>

<p>Intuitively, the mapping is:</p>

<ul>
  <li><strong>A to S</strong></li>
  <li><strong>B to U</strong></li>
  <li>C to T</li>
  <li>D to U</li>
  <li><strong>E to V</strong></li>
  <li><strong>F to U</strong></li>
</ul>

<p>Points C and D are roughly equal to T and U, so we’ll only focus on the bold ones.</p>

<h3 id="measures">Measures</h3>

<p>To extract the width and height of lines in both states, we inspect them in its final form and determine relative lengths compared to the drawable bounds:</p>

<figure class="center-align">
	<img src="http://i.imgur.com/6tgjmsm.png" title="measures" />
	<figcaption>Measuring agains the bounds.</figcaption>
</figure>

<p>At <em>hdpi</em> density, the estimates are:</p>

<ul>
  <li>$l$ = 60% of bounds.width</li>
  <li>$g$ = 15% of bounds.height</li>
  <li>$w$ = 5% of bounds.height</li>
  <li>$m$ = l/2</li>
  <li>$t$ =  45 deg</li>
</ul>

<p>Rememeber the variable names, as they will be used throughout this post.</p>

<h3 id="progress">Progress</h3>

<p>To get a smooth transition from e.g. A to S, we have to know the inbetween point at each animation frame. But first, we have to decide how to track animation progress.</p>

<p>Assuming we’ll use property animation, it’s on us to provide a property and set of values we want to animate between.</p>

<p>Let <em>progress</em> denote an arbitrary float value between 0.0 and 1.0, inclusive. This will be our property. We’ll start the animation by executing</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ObjectAnimator</span> <span class="n">o</span> <span class="o">=</span> <span class="n">ObjectAnimator</span><span class="o">.</span><span class="na">ofFloat</span><span class="o">(</span><span class="n">drawable</span><span class="o">,</span> <span class="s">"progress"</span><span class="o">,</span> <span class="mi">0</span><span class="n">f</span><span class="o">,</span> <span class="mi">1</span><span class="n">f</span><span class="o">);</span>
<span class="n">o</span><span class="o">.</span><span class="na">setDuration</span><span class="o">(</span><span class="n">animationDuration</span><span class="o">)</span>
<span class="n">o</span><span class="o">.</span><span class="na">start</span><span class="o">();</span></code></pre></div>

<p>If progress is 0, we show the menu icon. Else if progress is 1, we show the back-arrow icon.</p>

<p>Progressing from 0 to 1 transforms a home icon to a back-arrow. Conversely, 1 to 0 goes from a back-arrow to home.</p>

<p><a name="sec_4"></a></p>

<h3 id="math">Math</h3>

<p>Remember, the points we refer to are all defined in the <a href="#sec_1">upper section</a>.</p>

<figure class="center-align">
	<img src="http://i.imgur.com/3n4SaAz.png" title="A to S" />
	<figcaption>Pic 1</figcaption>
</figure>

<p>P is the point at progress $0 &lt; q &lt; 1$, moving between A and S. We want to know $dx$ and $dy$.</p>

<p>Let’s find coordinates of S first, assuming A is the origin. 
Clearly its $x$ coordinate is $m$. To determine $n$, a bigger picture helps:</p>

<figure class="center-align">
	<img src="http://i.imgur.com/Zq5PZ5D.png" title="Bigger A to S" />
	<figcaption>Pic 2</figcaption>
</figure>

<p>Assume $z = g + n$ and $h$ the length between S and D. Recall $t = 45 \deg$. Using trigonometric ratios, we know</p>

<script type="math/tex; mode=display">\sin t = \frac{z}{h}</script>

<p>We can get $h$ from</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\cos t &= \frac{m}{h}\\
\frac{\sqrt 2}{2} &= \frac{m}{h}\\
h &= m\sqrt 2\\
\end{align} %]]></script>

<p>Since $h$ is of the same length as the diagonal of a square with an edge $m$, we deduct $z=m$, thus $n = (m-g)$ and $S=(m, (m-g))$.</p>

<p>Observe that in pic 1, at progress $p=0$, we must be at A. When $p=1$, we must be at S. It’s clear that at progress $q$</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
dx &= qm \\
dy &= q(m-g)
\end{align} %]]></script>

<p>Another movement we have to take care of is B to D:</p>

<figure class="center-align">
	<img src="http://i.imgur.com/TheualZ.png" title="B to D" />
	<figcaption>Pic 3</figcaption>
</figure>

<p>Only $dg$ is changing. Applying similar logic as above, we know</p>

<script type="math/tex; mode=display">dg = qg</script>

<p>Note that C-D line (or T-U) is a mirror line. As such, reflecting the $y$ coordinate gets us E-F line changes for free.</p>

<blockquote>
  <p>To read more about the approach we’ve taken, visit the <a href="http://en.wikipedia.org/wiki/Linear_interpolation">linear interpolation</a> wiki page.</p>
</blockquote>

<h3 id="draw">Draw</h3>

<p>As mentioned, both drawable states have only three simple lines. <code>Canvas</code> has a convenient method <code>drawLine</code>, which is all we need.</p>

<p>To be able to draw, we need to calculate <code>dx</code>,  <code>dy</code> and <code>dv</code> and know points A, B, C, D, E, F.</p>

<p>First three change when progress changes, but others just need bounds. We can compute them in a helper method, which is only invoked when the bounds are set.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">measure</span><span class="o">()</span> <span class="o">{</span>
	<span class="kd">final</span> <span class="n">Rect</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">getBounds</span><span class="o">();</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">w</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="na">width</span><span class="o">();</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="na">height</span><span class="o">();</span>

	<span class="kd">final</span> <span class="kt">float</span> <span class="n">lineLength</span> <span class="o">=</span> <span class="n">LINE_LENGTH</span> <span class="o">*</span> <span class="n">w</span><span class="o">;</span>
	<span class="n">mHalfLineLength</span> <span class="o">=</span> <span class="n">lineLength</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>

	<span class="n">mLineGap</span> <span class="o">=</span> <span class="n">LINE_GAP</span> <span class="o">*</span> <span class="n">h</span><span class="o">;</span>

	<span class="kd">final</span> <span class="kt">float</span> <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">LINE_WIDTH</span> <span class="o">*</span> <span class="n">h</span><span class="o">;</span>
	<span class="n">mPaint</span><span class="o">.</span><span class="na">setStrokeWidth</span><span class="o">(</span><span class="n">strokeWidth</span><span class="o">);</span>

	<span class="n">mCenterY</span> <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
	<span class="n">mStartX</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="na">left</span> <span class="o">+</span> <span class="o">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">lineLength</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
	<span class="n">mEndX</span> <span class="o">=</span> <span class="n">mStartX</span> <span class="o">+</span> <span class="n">lineLength</span><span class="o">;</span>
	<span class="n">mTopY</span> <span class="o">=</span> <span class="n">mCenterY</span> <span class="o">-</span> <span class="n">mLineGap</span><span class="o">;</span>
	<span class="n">mBottomY</span> <span class="o">=</span> <span class="n">mCenterY</span> <span class="o">+</span> <span class="n">mLineGap</span><span class="o">;</span>

	<span class="n">invalidateSelf</span><span class="o">();</span>
<span class="o">}</span></code></pre></div>

<p>In the code above, <code>mHalfLineLength</code> denotes $m$, <code>mLineGap</code> denotes $g$ and <code>strokeWidth</code> is $w$. Other instance variables fully determine the points:</p>

<ul>
  <li>A(<code>mStartX</code>, <code>mTopY</code>)</li>
  <li>B(<code>mEndX</code>, <code>mTopY</code>)</li>
  <li>C(<code>mStartX</code>, <code>mCenterY</code>)</li>
  <li>D(<code>mEndX</code>, <code>mCenterY</code>)</li>
  <li>E(<code>mStartX</code>, <code>mBottomY</code>)</li>
  <li>F(<code>mEndX</code>, <code>mBottomY</code>)</li>
</ul>

<p>Each time progress is updated, we invalidate the drawable. Consequently, <code>draw</code> method is invoked</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">(</span><span class="n">Canvas</span> <span class="n">canvas</span><span class="o">)</span> <span class="o">{</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mHalfLineLength</span><span class="o">;</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="o">(</span><span class="n">mHalfLineLength</span> <span class="o">-</span> <span class="n">mLineGap</span><span class="o">);</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dg</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mLineGap</span><span class="o">;</span>

	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span> <span class="o">+</span> <span class="n">dx</span><span class="o">,</span> <span class="n">mTopY</span> <span class="o">-</span> <span class="n">dy</span><span class="o">,</span> <span class="n">mEndX</span><span class="o">,</span> <span class="n">mTopY</span> <span class="o">+</span> <span class="n">dg</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span><span class="o">,</span> <span class="n">mCenterY</span><span class="o">,</span> <span class="n">mEndX</span><span class="o">,</span> <span class="n">mCenterY</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span> <span class="o">+</span> <span class="n">dx</span><span class="o">,</span> <span class="n">mBottomY</span> <span class="o">+</span> <span class="n">dy</span><span class="o">,</span> <span class="n">mEndX</span><span class="o">,</span> <span class="n">mBottomY</span> <span class="o">-</span> <span class="n">dg</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
<span class="o">}</span></code></pre></div>

<p>Note that we apply the transformations computed in the <a href="#sec_4">math section</a>.</p>

<h3 id="demo">Demo</h3>

<p>Because I’m nice, I’ve wrapped everything we’ve done so far in a widget for you to try out:</p>

<div class="center-align">
	<div>
	    <canvas id="canvas" width="300" height="300" style="border:1px solid #000000;" />
	</div>
	<div>0.0
	    <input id="slider" type="range" min="0.0" max="1.0" step="0.01" value="0.0" width="300" />1.0
	    <p id="prog"></p>
	</div>
</div>

<h3 id="class-4-strategic-theatre-emergency">Class 4 Strategic Theatre Emergency</h3>

<p>If progress is 1, the above widget reveals the pointy end of the arrow is not really pointy.</p>

<p>When drawing on a <code>Canvas</code> instance, Android uses <a href="https://code.google.com/p/skia/">Skia</a>, a 2D graphics library, to do the actual drawing. <code>Canvas.drawLine</code> invokes a native method <code>SkCanvas::drawLine</code>, which invokes <code>SkCanvas::onDrawPoints</code>. Because our <code>mPaint</code> instance is not complex (it has no path effects, for example), <code>SkPaint::doComputeFastBounds</code> is called.</p>

<p>We care because in this case, if the <code>mPaint</code> stroke width is $w$, the rendered point has a radius of $w/2$.</p>

<p>Here’s a zoomed in look at U, where B and F meet and progress is 1:</p>

<figure class="center-align">
	<img src="http://i.imgur.com/4pGRr4J.png" title="source: imgur.com" />
	<figcaption>
	Line A-B (S-U) is colored purple. Line E-F (V-U) is colored green. Red square is the issue we're trying to resolve. </figcaption>
</figure>

<p>If we offset B and F by $(zx, -zy), (zx, zy)$ respectively, we cover the red square.</p>

<p>Because of the above analysis, we know $r=\frac{w}{2}$. Both lines come at a 45 degree angle, hence $k = 45\deg$ too. We can use trigonometric ratios again:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
zx &= h\cos k \\
zy &= h\sin k
\end{align} %]]></script>

<p>Because $\cos 45 = \sin 45 = \frac{\sqrt 2}{2}$ and $h= \frac{w}{2}$, we get</p>

<script type="math/tex; mode=display">zx = \frac{w}{2} \cdot \frac{\sqrt 2}{2} = zy = \frac{\sqrt 2}{4}w</script>

<p>Applying progress and updating the <code>draw</code> method, we get</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">(</span><span class="n">Canvas</span> <span class="n">canvas</span><span class="o">)</span> <span class="o">{</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mHalfLineLength</span><span class="o">;</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="o">(</span><span class="n">mHalfLineLength</span> <span class="o">-</span> <span class="n">mLineGap</span><span class="o">);</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dv</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mLineGap</span><span class="o">;</span>

	<span class="c1">// zx/zy computation can be easily moved to the measure method</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="o">((</span><span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="mi">2</span><span class="o">)/</span><span class="mi">4</span><span class="o">)*</span><span class="n">mPaint</span><span class="o">.</span><span class="na">getStrokeWidth</span><span class="o">());</span>

	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span> <span class="o">+</span> <span class="n">dx</span><span class="o">,</span> <span class="n">mTopY</span> <span class="o">-</span> <span class="n">dy</span><span class="o">,</span> <span class="n">mEndX</span> <span class="o">+</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mTopY</span> <span class="o">+</span> <span class="n">dv</span> <span class="o">+</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span><span class="o">,</span> <span class="n">mCenterY</span><span class="o">,</span> <span class="n">mEndX</span><span class="o">,</span> <span class="n">mCenterY</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span> <span class="o">+</span> <span class="n">dx</span><span class="o">,</span> <span class="n">mBottomY</span> <span class="o">+</span> <span class="n">dy</span><span class="o">,</span> <span class="n">mEndX</span> <span class="o">+</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mBottomY</span> <span class="o">-</span> <span class="n">dv</span> <span class="o">-</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
<span class="o">}</span></code></pre></div>

<h3 id="again-demo">Again, demo</h3>

<p>Confirm the fix in previous section resolves the issue:</p>

<div class="center-align">
	<div>
	    <canvas id="canvas2" width="300" height="300" style="border:1px solid #000000;" />
	</div>
	<div>0.0
	    <input id="slider2" type="range" min="0.0" max="1.0" step="0.01" value="0.0" width="300" />1.0
	    <p id="prog2"></p>
	</div>
</div>

<h3 id="a-final-touch">A final touch</h3>

<p>To finish off, we have to add rotation. The one in <a href="http://www.google.com/design/spec/animation/delightful-details.html">delightful details</a> goes from:</p>

<ul>
  <li>0 to 180, if progress goes from 0 to 1</li>
  <li>-180 to 0, if progress goes from 1 to 0</li>
</ul>

<p>Because, at this point, you are a master of linear interpolation, the updated <code>draw</code> method makes sense</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">(</span><span class="n">Canvas</span> <span class="n">canvas</span><span class="o">)</span> <span class="o">{</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mHalfLineLength</span><span class="o">;</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="o">(</span><span class="n">mHalfLineLength</span> <span class="o">-</span> <span class="n">mLineGap</span><span class="o">);</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dg</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mLineGap</span><span class="o">;</span>

	<span class="c1">// dx/dy computation was moved to measure method</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">mArrowFactor</span><span class="o">;</span>

	<span class="c1">// mIsBack is true if the icon is currently showing the back arrow</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">rotationTarget</span> <span class="o">=</span> <span class="n">mIsBack</span> <span class="o">?</span> <span class="o">-</span><span class="mi">180</span> <span class="o">:</span> <span class="mi">180</span><span class="o">;</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">rotation</span> <span class="o">=</span> <span class="n">mProgress</span> <span class="o">*</span> <span class="n">rotationTarget</span><span class="o">;</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">pivotX</span> <span class="o">=</span> <span class="n">getBounds</span><span class="o">.</span><span class="na">centerX</span><span class="o">();</span>
	<span class="kd">final</span> <span class="kt">float</span> <span class="n">pivotY</span> <span class="o">=</span> <span class="n">getBounds</span><span class="o">().</span><span class="na">centerY</span><span class="o">();</span>

	<span class="n">canvas</span><span class="o">.</span><span class="na">save</span><span class="o">();</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">rotate</span><span class="o">(</span><span class="n">rotation</span><span class="o">,</span> <span class="n">pivotX</span><span class="o">,</span> <span class="n">pivotY</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span> <span class="o">+</span> <span class="n">dx</span><span class="o">,</span> <span class="n">mTopY</span> <span class="o">-</span> <span class="n">dy</span><span class="o">,</span> <span class="n">mEndX</span> <span class="o">+</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mTopY</span> <span class="o">+</span> <span class="n">dg</span> <span class="o">+</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span><span class="o">,</span> <span class="n">mCenterY</span><span class="o">,</span> <span class="n">mEndX</span><span class="o">,</span> <span class="n">mCenterY</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">mStartX</span> <span class="o">+</span> <span class="n">dx</span><span class="o">,</span> <span class="n">mBottomY</span> <span class="o">+</span> <span class="n">dy</span><span class="o">,</span> <span class="n">mEndX</span> <span class="o">+</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mBottomY</span> <span class="o">-</span> <span class="n">dg</span> <span class="o">-</span> <span class="n">dz</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
	<span class="n">canvas</span><span class="o">.</span><span class="na">restore</span><span class="o">();</span>
<span class="o">}</span></code></pre></div>

<h3 id="parting-words">Parting words</h3>

<p>Good on ya for making it this far. I hope math section was clear enough, and the widgets helped. I’m sure some parts can be improved, so I’ll be grateful for any feedback I get. The full implementation is <a href="https://github.com/tslamic/DelightfulMenuDrawable">available on GitHub</a>.</p>

<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
	});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">

	var DelightfulDrawable = {};

	DelightfulDrawable.newInstance = function (canvasId, sliderId, progressId, isPointy) {

	    // Elements
	    var canvas = document.getElementById(canvasId);
	    var slider = document.getElementById(sliderId);
	    var progress = document.getElementById(progressId);
	    var context = canvas.getContext("2d");

	    // Event handler
	    slider.addEventListener("input", function () {
	    	update(slider.value);
	    }, false);

	    // Bounds
	    var width = canvas.width;
	    var height = canvas.height;

	    // Measure
	    var l = 0.60 * width;
	    var g = 0.15 * height;
	    var w = 0.05 * height;
	    var m = l / 2;

	    // Helpers
	    var centerY = height / 2;
	    var startX = (width - l) / 2;
	    var endX = startX + l;
	    var topY = centerY - g;
	    var bottomY = centerY + g;
	    var pointyFactor = isPointy ? (.3536 * w) : 0;

	    // Show UI
	    context.lineWidth = w;
	    update(0.0);

	    function update(prog) {
	    	progress.innerHTML = "Current progress: " + parseFloat(prog).toFixed(2);
	    	draw(context, prog);
	    }

	    function draw(canv, prog) {
	    	var dx = prog * m;
	    	var dy = prog * (m - g);
	    	var dg = prog * g;
	    	var dz = prog * pointyFactor;

	        // Reset canvas
	        canv.clearRect(0, 0, width, height);
	        canv.beginPath();

	        // Top line
	        canv.moveTo(startX + dx, topY - dy);
	        canv.lineTo(endX + dz, topY + dg + dz);

	        // Middle line
	        canv.moveTo(startX, centerY);
	        canv.lineTo(endX, centerY);

	        // Bottom line
	        canv.moveTo(startX + dx, bottomY + dy);
	        canv.lineTo(endX + dz, bottomY - dg - dz);

	        // Draw
	        canv.closePath();
	        canv.stroke();
	    }

	};

	DelightfulDrawable.newInstance("canvas", "slider", "prog", false);
	DelightfulDrawable.newInstance("canvas2", "slider2", "prog2", true);

</script>


      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags/#android" title="Pages tagged android" class="tag"><span class="term">android</span></a><a href="/tags/#ui" title="Pages tagged ui" class="tag"><span class="term">ui</span></a><a href="/tags/#drawable" title="Pages tagged drawable" class="tag"><span class="term">drawable</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/android-menu-icon/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=/android-menu-icon/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=/android-menu-icon/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="/on-advanced-task-killer/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="/builders-and-required-params/" title="Builders and Required Params">Builders and Required Params</a></h3>
      <p>How to handle builders with required parameters <a href="/builders-and-required-params/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="/creating-android-device-names/" title="Creating AndroidDeviceNames">Creating AndroidDeviceNames</a></h4>
        <span>Published on August 22, 2015</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="/sync-folders-with-python/" title="Sync folders with Python">Sync folders with Python</a></h4>
        <span>Published on May 30, 2015</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Tadej Slamic. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/" rel="notfollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44812127-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'tslamic'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
